class ABTest{constructor(t={}){this.tests=t.tests||{},this.cookieDuration=t.cookieDuration||30,this.analyticsCallback=t.analyticsCallback||null,this.debug=t.debug||!1}getVariant(t){const e=this.tests[t];if(!e)return console.warn(`A/B test "${t}" not found`),"control";const n=`ab_${t}`;let a=this.getCookie(n);return a||(a=this.assignVariant(e.variants),this.setCookie(n,a,this.cookieDuration),this.track("ab_test_assigned",{test:t,variant:a})),this.debug&&console.log(`A/B Test: ${t} = ${a}`),a}assignVariant(t){const e=t.reduce((t,e)=>t+(e.weight||1),0);let n=Math.random()*e;for(const e of t)if(n-=e.weight||1,n<=0)return e.name;return t[0].name}track(t,e={}){const n={...e};for(const t in this.tests)n[`ab_${t}`]=this.getVariant(t);"undefined"!=typeof gtag&&gtag("event",t,n),this.analyticsCallback&&this.analyticsCallback(t,n),this.debug&&console.log("A/B Test Event:",t,n)}apply(t,e){const n=this.getVariant(t),a=e[n];a&&"function"==typeof a?a():e.default&&e.default()}getCookie(t){const e=`; ${document.cookie}`.split(`; ${t}=`);return 2===e.length?e.pop().split(";").shift():null}setCookie(t,e,n){const a=new Date;a.setTime(a.getTime()+24*n*60*60*1e3);const i=`expires=${a.toUTCString()}`;document.cookie=`${t}=${e};${i};path=/`}getTestSummary(){const t={};for(const e in this.tests)t[e]=this.getVariant(e);return t}forceVariant(t,e){const n=`ab_${t}`;this.setCookie(n,e,this.cookieDuration)}clearTests(){for(const t in this.tests){const e=`ab_${t}`;document.cookie=`${e}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/`}}}"undefined"!=typeof module&&module.exports&&(module.exports=ABTest);